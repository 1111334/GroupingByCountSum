CREATE TABLE MEAL_ORDER(
TIME_MEAL_ORDERED TIMESTAMP,
  MEAL_NAME VARCHAR(255),
  NUMBER INT(10),
  PRICE FLOAT(20),
  CALORIES INT(20)
);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(NOW(), 'Spaghetti Bolognese', 12, 14.00, 500);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 1 HOUR), 'Grilled Chicken Sandwich', 5, 22.00, 600);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 2 HOUR), 'Pesto Pasta', 6, 12.00, 550);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 3 HOUR), 'Pesto Pasta', 9, 12.00, 550);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 4 HOUR), 'Grilled Chicken Sandwich', 4, 22.00, 600);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 5 HOUR), 'Pesto Pasta', 7, 12.00, 550);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 6 HOUR), 'Spaghetti Bolognese', 10, 14.00, 600);

INSERT INTO MEAL_ORDER(TIME_MEAL_ORDERED, MEAL_NAME, NUMBER, PRICE, CALORIES)
VALUES(DATE_ADD(NOW(), INTERVAL 7 HOUR), 'Pesto Pasta', 2, 12.00, 550);


SELECT MEAL_NAME, COUNT(NUMBER) AS NUMBER_ORDINI
FROM MEAL_ORDER
GROUP BY MEAL_NAME;

SELECT SUM(PRICE) AS ENTRATE_TOTALI
FROM MEAL_ORDER
WHERE PRICE > 15;

SELECT MEAL_NAME, COUNT(*) AS NUMBER_MEAL
FROM MEAL_ORDER
WHERE CALORIES > 500
GROUP BY MEAL_NAME;

SELECT SUM(PRICE) AS TOTAL_PRICE
FROM MEAL_ORDER
WHERE LOWER(MEAL_NAME) LIKE '%S%';

SELECT MEAL_NAME, COUNT(NUMBER) AS NUMBER_ORDER
FROM MEAL_ORDER
WHERE TIME_MEAL_ORDERED < '2023-09-21 18:00:00'
GROUP BY MEAL_NAME;
